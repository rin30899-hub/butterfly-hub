<!doctype html><html><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title><%= title %> â€“ <%= siteTitle %></title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head><body>
  <%- include('partials/navbar') %>
  <main class="container py-4">
    <h1 class="h5 mb-3">Gallery</h1>
    <div id="list" class="row g-3"></div>
  </main>
  <script>
  (async function(){
    const res = await fetch("/api/drawings"); const items = await res.json();
    const list = document.getElementById("list");
    list.innerHTML = items.map(i => `
      <div class="col-md-4">
        <div class="card h-100 p-3">
          <h5>${i.title}</h5>
          <small class="text-muted">${i.created}</small>
          <div class="mt-2 d-flex gap-2">
            <a class="btn btn-sm btn-outline-success" href="/api/drawings/${i.id}" target="_blank">JSON</a>
            <button class="btn btn-sm btn-outline-primary" onclick="load(${i.id})">Load in Studio</button>
            <button class="btn btn-sm btn-outline-danger" onclick="del(${i.id})">Delete</button>
          </div>
        </div>
      </div>`).join("");
  })();
  async function load(id){ const r = await fetch("/api/drawings/"+id); const d = await r.json();
    localStorage.setItem("butterfly.load", d.json); location.href="/studio"; }
  async function del(id){ if(!confirm("Delete this drawing?")) return;
    const r = await fetch("/api/drawings/"+id, { method:"DELETE" }); if(r.ok) location.reload();
  }
  </script>
</body></html>
